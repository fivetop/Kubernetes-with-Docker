## 파일비트를 활용한 아파치 웹 서버 로그 수집
![image](https://user-images.githubusercontent.com/62214428/146667737-cc6c1e59-13b7-44a7-bb60-8def9c4582d9.png)

아파치 설치하기

```bash
apt install apache2 -y
```

파일비트 7.14.1 deb 32비트 다운로드 명령어 실행

```bash
wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.14.1-amd64.deb --no-check-certificate
sudo dpkg -i filebeat-7.14.1-amd64.deb
```

output.elasticsearch를 찾아서 호스트 위치가 정확한지 확인
```
sudo vim /etc/filebeat/filebeat.yml
-> output.elasticsearch에서 hosts:[] 부분 확인
-> ex) hosts:["localhost:9200"]처럼 엘라스틱서치 url확인
```

파일비트 모듈 설정으로 apache2 로그 수집

```bash
cd /etc/filebeat/modules.d
cp apache.yml.disabled apache.yml
vim apache.yml
```

모듈에 다음과 같이 경로를 설정

```bash
- module: apache
  access:
    enabled: true
    var.paths: ["/var/log/apache2/access.log*"]
  error:
    enabled: true
    var.paths: ["/var/log/apache2/error.log*"]
```

-> ★여기서 잠깐.. path를 보니 쿠버네티스 클러스터 로그수집도 어떻게 하면 될지 감이 와야한다!!

설정을 위해 재시작

```bash
sudo /etc/init.d/filebeat restart
journalctl -u filebeat # 로그 확인
```

마지막으로 인덱스 패턴 확인 및 추가
![image](https://user-images.githubusercontent.com/62214428/146667861-fbc46520-204c-4251-80e5-9a7178d74e92.png)

