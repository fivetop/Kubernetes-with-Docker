## 도커 레지스트리
도커 레지스트리는 도커 이미지들을 모아 놓고 필요할 때 사용할 수 있도록 구축한 저장소.   
도커 이미지를 빌드하거나 컨테이너를 실행할 수 있었던 것도 레지스트리의 이미지를 사용했기 때문.

도커라는 플랫폼을 정의했던 문장이 다음과 같다.

`도커는 어플리케이션 및 실행 환경을 정의한 이미지를 생성/공유함과 동시에, 이를 이용하여 컨테이너를 작동할 수 있도록 하는 플랫폼이다.`

레지스트리를 통하여 이미지를 공유하는 여러 가지 방법과 이용 가능한 플랫폼 등을 확인해보자

-----------
- 도커의 기능을 한 눈에 알아볼 수 있는 사진
![화면 캡처 2021-08-29 141752](https://user-images.githubusercontent.com/62214428/131239395-fe6ff6c8-145c-49a3-bbdc-a2c72e71293c.png)

Dockerfile을 통해 빌드된 이미지가 컨테이너를 실행하는 데에 이용되기도 하고, 혹은 레지스트리에 저장되어 여러 사람이 사용할 수 있도록 공개.  
이를 각각 Building, Running, Shipping(Sharing) 이라는 단어로 표현.  

도커 이미지가 공유되는 레지스트리를 크게 3가지로 구분해보면, 디폴트로 이미지를 받아오는 도커의 `도커 허브`,  
사용자가 직접 컨테이너에 구축한 `로컬 레지스트리`, 클라우드 사업자에서 제공하는 `컨테이너 레지스트리`가 있다.

레지스트리 구축전에 레지스트리를 사용하는 목적에 대해 알고 넘어가자.   
이미지를 파일 형식으로도 저장 가능한데 왜 굳이 비용을 지불하면서 레지스트리를 사용하는 걸까? 
![화면 캡처 2021-08-29 142158](https://user-images.githubusercontent.com/62214428/131239534-3564d672-21ec-495f-9907-e3c7d88d9656.png)

첫 번째는 `보안 문제`.  
이미지 내부에 보안상 중요한 파일이나 내용이 필요한 경우에는 더욱 엄격히 관리할 필요가 있다.  
이미지 자체도 암호화 되어야 하고 레지스트리에 접근할 수 있는 권한도 통제.  
이런 일련의 것들을 클라우드 사업자에서는 `IAM(Identity and Access Management)` 라는 형태로 제공. 

두 번째는 `배포 파이프라인 효율화`.  
위 그림에서 보다시피 레지스트리에 저장된 이미지는 단순히 저장에서 끝나는 것이 아니라 CI/CD 라는 과정까지 연속적으로 활용.

**CI(Continuous Integration) : 지속적 통합**
빌드/테스트가 자동으로 수행된 이후 개발자의 수정 사항이 중앙 저장소에 머지되는 것 까지의 과정
일련의 자동화 과정 및 개발 문화가 포괄

**CD(Continuous Delivery) : 지속적 전달**
운영 환경에 배포할 소스코드가 자동으로 세팅
빌드 이후의 변경 사항을 테스트 및 운영 서버에 자동으로 배포
필요에 따라 테스트 서버를 동적으로 생성할 수 있음


지금부터 하고자 하는 것 : 이미지 파일을 저장하는 레지스트리에 이미지 파일을 저장하기

------------

## 5.1 도커 허브
도커 허브는 도커에서 디폴트로 참조하는 레지스트리로서, 각종 공식 이미지를 손쉽게 사용할 수 있도록 구성되어 있다. 

### 먼저 레포지토리 생성
![화면 캡처 2021-08-29 151050](https://user-images.githubusercontent.com/62214428/131240591-d1dbdb91-44e9-45ca-93f1-b1e8ae19da33.png)

### 우분투에서 도커 레지스트리에 올릴 이미지를 빌드 
`sudo docker build -t <계정명>/<저장소명>:[태그명] .`  
빌드 명령어는 규칙으로 잘 기억하자.
![화면 캡처 2021-08-29 151211](https://user-images.githubusercontent.com/62214428/131240614-76053722-659d-4ae0-8b1c-c95faa784970.png)

- 도커 파일은 아래처럼 구성
![화면 캡처 2021-08-29 151348](https://user-images.githubusercontent.com/62214428/131240641-6bcce0ca-f8ad-42cd-907a-89d410b1e6ec.png)
```
FROM nginx:alpine
# alpine은 경량화 리눅스 배포판 입니다. 
# 도커 베이스 이미지로 alpine 리눅스를 활용하는 이유는 이미지 용량을 적게 차지할 뿐만 아니라 처리속도가 빠르다는 이점이 있기 때문입니다. 

WORKDIR /usr/share/nginx/html
# 이 경로는 nginx 웹서버의 index.html 파일이 위치한 곳입니다.
# 브라우저를 통해 웹서버로 접근했을때 로드되는 페이지가 바로 이 곳을 참조하여 렌더링 되는 것입니다.

RUN rm -rf ./*
# 클론한 소스를 이미지에 복사하기 위해 기존 이미지 내의 파일을 전부 삭제합니다.

COPY ./* ./
# Dockerfile이 위치한 경로의 html, css, js 등의 파일을 이미지 내로 복사합니다.    // 도커파일이 위치한 경로의 모든 파일 ./*을 현재 WORKDIR 경로( ./ )로 

ENTRYPOINT ["nginx", "-g", "daemon off;"]
# nginx 웹서버를 기동합니다.

```
### 만든 이미지를 푸쉬할 차례
![화면 캡처 2021-08-29 151721](https://user-images.githubusercontent.com/62214428/131240693-a080ee18-3d9a-4629-9355-37f276ef4162.png)
![화면 캡처 2021-08-29 151748](https://user-images.githubusercontent.com/62214428/131240704-558d39a2-e5fa-4e07-a207-c038ac4d5e9c.png)







